<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Controle de Horas - CNPJ</title>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: #f5f7fa;
            color: #333;
            line-height: 1.6;
            padding: 20px;
        }
        
        .container {
            max-width: 1000px;
            margin: 0 auto;
            background: white;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            padding: 25px;
        }
        
        header {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 1px solid #eaeaea;
        }
        
        h1 {
            color: #2c3e50;
            margin-bottom: 10px;
        }
        
        .configuracao {
            background-color: #e8f4fc;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
        }
        
        .configuracao h3 {
            margin-bottom: 15px;
            color: #2c3e50;
        }
        
        .config-group {
            display: flex;
            gap: 15px;
            align-items: center;
            margin-bottom: 10px;
        }
        
        .config-group label {
            min-width: 150px;
            font-weight: 600;
        }
        
        .config-group input {
            flex: 1;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
        }
        
        .btn-config {
            background-color: #2ecc71;
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 5px;
            cursor: pointer;
            font-weight: 600;
        }
        
        .btn-config:hover {
            background-color: #27ae60;
        }
        
        .salario-info {
            background-color: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            text-align: center;
            font-size: 1.1em;
        }
        
        .salario-info span {
            font-weight: bold;
            color: #27ae60;
        }
        
        .form-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 20px;
        }
        
        .form-group {
            margin-bottom: 15px;
        }
        
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #2c3e50;
        }
        
        input, select {
            width: 100%;
            padding: 12px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 16px;
        }
        
        button {
            background-color: #3498db;
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            transition: background-color 0.3s;
            grid-column: span 2;
            justify-self: center;
            margin-top: 10px;
        }
        
        button:hover {
            background-color: #2980b9;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }
        
        th, td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }
        
        th {
            background-color: #f2f2f2;
            font-weight: 600;
        }
        
        tr:hover {
            background-color: #f9f9f9;
        }
        
        .resumo {
            background-color: #e8f4fc;
            padding: 20px;
            border-radius: 8px;
            margin-top: 30px;
        }
        
        .resumo h3 {
            margin-bottom: 15px;
            color: #2c3e50;
        }
        
        .resumo-item {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
            font-size: 1.1em;
        }
        
        .valor-total {
            font-weight: bold;
            font-size: 1.3em;
            margin-top: 10px;
            padding-top: 10px;
            border-top: 1px solid #ccc;
        }
        
        .positivo {
            color: #27ae60;
        }
        
        .negativo {
            color: #e74c3c;
        }
        
        .acoes {
            display: flex;
            gap: 10px;
        }
        
        .btn-excluir {
            background-color: #e74c3c;
            padding: 6px 12px;
            font-size: 14px;
        }
        
        .btn-excluir:hover {
            background-color: #c0392b;
        }
        
        .btn-limpar-tudo {
            background-color: #e67e22;
            margin-top: 15px;
        }
        
        .btn-limpar-tudo:hover {
            background-color: #d35400;
        }
        
        .horas-input {
            display: flex;
            gap: 10px;
            align-items: center;
        }
        
        .horas-input input {
            width: 80px;
            text-align: center;
        }
        
        .btn-horas {
            background-color: #2ecc71;
            padding: 8px 12px;
            font-size: 16px;
            border-radius: 5px;
            cursor: pointer;
        }
        
        .btn-horas:hover {
            background-color: #27ae60;
        }
        
        .explicacao {
            background-color: #fff4e6;
            padding: 15px;
            border-radius: 8px;
            margin-top: 20px;
            font-size: 0.9em;
        }
        
        .status-salvamento {
            text-align: center;
            margin-top: 10px;
            font-size: 0.9em;
            color: #7f8c8d;
        }
        
        @media (max-width: 768px) {
            .form-container {
                grid-template-columns: 1fr;
            }
            
            .config-group {
                flex-direction: column;
                align-items: flex-start;
            }
            
            .config-group label {
                min-width: auto;
            }
            
            button {
                grid-column: 1;
            }
            
            .container {
                padding: 15px;
            }
            
            input, select, button {
                padding: 10px;
            }
            
            .horas-input {
                flex-wrap: wrap;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>Controle de Horas Extras e Descontos</h1>
            <p>Registre suas horas trabalhadas, horas extras e acompanhe seu rendimento</p>
        </header>
        
        <div class="configuracao">
            <h3>Configurações</h3>
            <div class="config-group">
                <label for="salario-mensal">Salário Mensal (R$):</label>
                <input type="number" id="salario-mensal" min="0" step="100" value="6500">
                <button class="btn-config" id="btn-atualizar-salario">Atualizar</button>
            </div>
            <div class="config-group">
                <label for="dias-uteis">Dias Úteis no Mês:</label>
                <input type="number" id="dias-uteis" min="1" max="31" value="22">
            </div>
            <div class="config-group">
                <label for="horas-dia">Horas por Dia:</label>
                <input type="number" id="horas-dia" min="1" max="24" value="8">
            </div>
        </div>
        
        <div class="salario-info">
            <p>Salário base: <span id="salario-base">R$ 6.500,00</span></p>
            <p>Valor por dia: <span id="valor-dia">R$ 295,45</span></p>
            <p>Valor por hora: <span id="valor-hora">R$ 36,93</span></p>
            <p>Valor por meia hora: <span id="valor-meia-hora">R$ 18,47</span></p>
        </div>
        
        <div class="form-container">
            <div class="form-group">
                <label for="data">Data:</label>
                <input type="date" id="data" required>
            </div>
            
            <div class="form-group">
                <label for="tipo-registro">Tipo de registro:</label>
                <select id="tipo-registro">
                    <option value="trabalhado">Horas trabalhadas</option>
                    <option value="extra">Horas extras</option>
                    <option value="falta">Falta / Ausência</option>
                </select>
            </div>
            
            <div class="form-group">
                <label for="horas">Quantidade de horas:</label>
                <div class="horas-input">
                    <input type="number" id="horas" min="0.5" step="0.5" value="8" readonly>
                    <button type="button" class="btn-horas" id="btn-mais-0.5">+0.5h</button>
                    <button type="button" class="btn-horas" id="btn-menos-0.5">-0.5h</button>
                </div>
                <small>Use os botões para ajustar em incrementos de 0.5h</small>
            </div>
            
            <div class="form-group">
                <label for="descricao">Descrição (opcional):</label>
                <input type="text" id="descricao" placeholder="Ex: Reunião com cliente">
            </div>
            
            <button id="btn-adicionar">Adicionar Registro</button>
        </div>
        
        <table id="tabela-registros">
            <thead>
                <tr>
                    <th>Data</th>
                    <th>Tipo</th>
                    <th>Horas</th>
                    <th>Valor</th>
                    <th>Descrição</th>
                    <th>Ações</th>
                </tr>
            </thead>
            <tbody>
                <!-- Os registros serão inseridos aqui via JavaScript -->
            </tbody>
        </table>
        
        <div class="resumo">
            <h3>Resumo</h3>
            <div class="resumo-item">
                <span>Total de horas extras:</span>
                <span id="total-horas-extras">0 horas</span>
            </div>
            <div class="resumo-item">
                <span>Total de horas em falta:</span>
                <span id="total-horas-falta">0 horas</span>
            </div>
            <div class="resumo-item">
                <span>Valor total de horas extras:</span>
                <span id="valor-horas-extras" class="positivo">R$ 0,00</span>
            </div>
            <div class="resumo-item">
                <span>Valor total de descontos:</span>
                <span id="valor-descontos" class="negativo">R$ 0,00</span>
            </div>
            <div class="resumo-item valor-total">
                <span>Salário final:</span>
                <span id="salario-final">R$ 6.500,00</span>
            </div>
            
            <button id="btn-limpar-tudo" class="btn-limpar-tudo">Limpar Todos os Registros</button>
        </div>
        
        <div class="status-salvamento" id="status-salvamento">
            Dados salvos automaticamente
        </div>
        
        <div class="explicacao">
            <h4>Como funciona o cálculo:</h4>
            <p>1. Seu salário base é calculado com base no valor mensal informado</p>
            <p>2. Cada hora extra trabalhada é acrescida ao salário</p>
            <p>3. Cada hora não trabalhada é descontada do salário</p>
            <p>4. Seus dados são salvos automaticamente no navegador</p>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Configurações iniciais
            let salarioBase = 6500;
            let diasUteisMes = 22;
            let horasPorDia = 8;
            
            let valorDia = salarioBase / diasUteisMes;
            let valorHora = valorDia / horasPorDia;
            let valorMeiaHora = valorHora / 2;
            
            // Elementos da interface
            const inputSalario = document.getElementById('salario-mensal');
            const inputDiasUteis = document.getElementById('dias-uteis');
            const inputHorasDia = document.getElementById('horas-dia');
            const btnAtualizarSalario = document.getElementById('btn-atualizar-salario');
            const inputHoras = document.getElementById('horas');
            const btnMaisMeia = document.getElementById('btn-mais-0.5');
            const btnMenosMeia = document.getElementById('btn-menos-0.5');
            const btnAdicionar = document.getElementById('btn-adicionar');
            const btnLimparTudo = document.getElementById('btn-limpar-tudo');
            const tabelaRegistros = document.getElementById('tabela-registros').getElementsByTagName('tbody')[0];
            const statusSalvamento = document.getElementById('status-salvamento');
            
            // Array para armazenar os registros
            let registros = [];
            
            // Carregar dados salvos
            function carregarDadosSalvos() {
                const dadosSalvos = localStorage.getItem('controleHorasDados');
                
                if (dadosSalvos) {
                    const dados = JSON.parse(dadosSalvos);
                    
                    // Carregar configurações
                    if (dados.config) {
                        inputSalario.value = dados.config.salario || 6500;
                        inputDiasUteis.value = dados.config.diasUteis || 22;
                        inputHorasDia.value = dados.config.horasDia || 8;
                    }
                    
                    // Carregar registros
                    if (dados.registros) {
                        registros = dados.registros;
                    }
                    
                    // Atualizar a interface
                    atualizarConfiguracoes();
                    atualizarTabela();
                    atualizarResumo();
                    
                    mostrarStatus('Dados carregados com sucesso', 'positivo');
                } else {
                    // Configurações iniciais
                    atualizarConfiguracoes();
                    mostrarStatus('Sistema pronto para uso');
                }
            }
            
            // Salvar dados no localStorage
            function salvarDados() {
                const dadosParaSalvar = {
                    config: {
                        salario: parseFloat(inputSalario.value) || 6500,
                        diasUteis: parseInt(inputDiasUteis.value) || 22,
                        horasDia: parseInt(inputHorasDia.value) || 8
                    },
                    registros: registros
                };
                
                localStorage.setItem('controleHorasDados', JSON.stringify(dadosParaSalvar));
                mostrarStatus('Dados salvos automaticamente', 'positivo');
            }
            
            // Mostrar status de salvamento
            function mostrarStatus(mensagem, tipo = '') {
                statusSalvamento.textContent = mensagem;
                statusSalvamento.className = 'status-salvamento';
                
                if (tipo === 'positivo') {
                    statusSalvamento.style.color = '#27ae60';
                } else if (tipo === 'negativo') {
                    statusSalvamento.style.color = '#e74c3c';
                } else {
                    statusSalvamento.style.color = '#7f8c8d';
                }
                
                // Limpar o status após 3 segundos
                setTimeout(() => {
                    statusSalvamento.textContent = 'Dados salvos automaticamente';
                    statusSalvamento.style.color = '#7f8c8d';
                }, 3000);
            }
            
            // Atualizar configurações
            function atualizarConfiguracoes() {
                salarioBase = parseFloat(inputSalario.value) || 6500;
                diasUteisMes = parseInt(inputDiasUteis.value) || 22;
                horasPorDia = parseInt(inputHorasDia.value) || 8;
                
                valorDia = salarioBase / diasUteisMes;
                valorHora = valorDia / horasPorDia;
                valorMeiaHora = valorHora / 2;
                
                // Atualizar informações na página
                document.getElementById('salario-base').textContent = formatarMoeda(salarioBase);
                document.getElementById('valor-dia').textContent = formatarMoeda(valorDia);
                document.getElementById('valor-hora').textContent = formatarMoeda(valorHora);
                document.getElementById('valor-meia-hora').textContent = formatarMoeda(valorMeiaHora);
                
                // Recalcular todos os registros com os novos valores
                recalcularRegistros();
                
                // Salvar as alterações
                salvarDados();
            }
            
            // Recalcular todos os registros com os valores atualizados
            function recalcularRegistros() {
                registros.forEach(function(registro) {
                    if (registro.tipo === 'extra') {
                        registro.valor = valorHora * registro.horas;
                    } else if (registro.tipo === 'falta') {
                        registro.valor = -valorHora * registro.horas;
                    }
                });
                
                // Atualizar a tabela e o resumo
                atualizarTabela();
                atualizarResumo();
            }
            
            // Configurar evento para o botão de atualizar
            btnAtualizarSalario.addEventListener('click', atualizarConfiguracoes);
            
            // Limpar todos os registros
            btnLimparTudo.addEventListener('click', function() {
                if (confirm('Tem certeza que deseja limpar todos os registros? Esta ação não pode ser desfeita.')) {
                    registros = [];
                    atualizarTabela();
                    atualizarResumo();
                    salvarDados();
                    mostrarStatus('Todos os registros foram removidos', 'negativo');
                }
            });
            
            // Controles de horas
            btnMaisMeia.addEventListener('click', function() {
                let horasAtuais = parseFloat(inputHoras.value);
                inputHoras.value = (horasAtuais + 0.5).toFixed(1);
            });
            
            btnMenosMeia.addEventListener('click', function() {
                let horasAtuais = parseFloat(inputHoras.value);
                if (horasAtuais > 0.5) {
                    inputHoras.value = (horasAtuais - 0.5).toFixed(1);
                }
            });
            
            // Adicionar novo registro
            btnAdicionar.addEventListener('click', function() {
                const data = document.getElementById('data').value;
                const tipo = document.getElementById('tipo-registro').value;
                const horas = parseFloat(inputHoras.value);
                const descricao = document.getElementById('descricao').value;
                
                if (!data) {
                    alert('Por favor, selecione uma data.');
                    return;
                }
                
                if (horas <= 0) {
                    alert('Por favor, informe uma quantidade de horas válida.');
                    return;
                }
                
                let valor = 0;
                let tipoDescricao = '';
                
                if (tipo === 'trabalhado') {
                    // Para horas trabalhadas normais, não há acréscimo, apenas evita desconto
                    valor = 0;
                    tipoDescricao = 'Horas trabalhadas';
                } else if (tipo === 'extra') {
                    valor = valorHora * horas;
                    tipoDescricao = 'Horas extras';
                } else if (tipo === 'falta') {
                    valor = -valorHora * horas;
                    tipoDescricao = 'Falta';
                }
                
                // Adicionar ao array de registros
                registros.push({
                    data: formatarData(data),
                    tipo,
                    horas,
                    valor,
                    descricao: descricao || tipoDescricao
                });
                
                // Atualizar a tabela e o resumo
                atualizarTabela();
                atualizarResumo();
                
                // Salvar os dados
                salvarDados();
                
                // Limpar o formulário
                document.getElementById('data').value = '';
                inputHoras.value = '8';
                document.getElementById('descricao').value = '';
                
                mostrarStatus('Registro adicionado com sucesso', 'positivo');
            });
            
            // Função para formatar data no formato dd/mm/aaaa
            function formatarData(dataISO) {
                const data = new Date(dataISO);
                return data.toLocaleDateString('pt-BR');
            }
            
            // Função para formatar valores monetários
            function formatarMoeda(valor) {
                return 'R$ ' + valor.toFixed(2).replace('.', ',');
            }
            
            // Função para formatar horas (1.5 vira "1h30")
            function formatarHoras(horasDecimais) {
                const horasInteiras = Math.floor(horasDecimais);
                const minutos = Math.round((horasDecimais - horasInteiras) * 60);
                
                if (minutos === 0) {
                    return `${horasInteiras}h`;
                } else {
                    return `${horasInteiras}h${minutos.toString().padStart(2, '0')}`;
                }
            }
            
            // Atualizar a tabela de registros
            function atualizarTabela() {
                // Limpar a tabela
                tabelaRegistros.innerHTML = '';
                
                // Adicionar cada registro à tabela
                registros.forEach(function(registro, index) {
                    const row = tabelaRegistros.insertRow();
                    
                    // Data
                    const cellData = row.insertCell(0);
                    cellData.textContent = registro.data;
                    
                    // Tipo
                    const cellTipo = row.insertCell(1);
                    cellTipo.textContent = registro.descricao;
                    
                    // Horas
                    const cellHoras = row.insertCell(2);
                    cellHoras.textContent = formatarHoras(registro.horas);
                    
                    // Valor
                    const cellValor = row.insertCell(3);
                    cellValor.textContent = formatarMoeda(registro.valor);
                    cellValor.className = registro.valor >= 0 ? 'positivo' : 'negativo';
                    
                    // Descrição
                    const cellDesc = row.insertCell(4);
                    cellDesc.textContent = registro.descricao;
                    
                    // Ações
                    const cellAcoes = row.insertCell(5);
                    cellAcoes.className = 'acoes';
                    
                    const btnExcluir = document.createElement('button');
                    btnExcluir.textContent = 'Excluir';
                    btnExcluir.className = 'btn-excluir';
                    btnExcluir.addEventListener('click', function() {
                        registros.splice(index, 1);
                        atualizarTabela();
                        atualizarResumo();
                        salvarDados();
                        mostrarStatus('Registro excluído', 'negativo');
                    });
                    
                    cellAcoes.appendChild(btnExcluir);
                });
            }
            
            // Atualizar o resumo
            function atualizarResumo() {
                let totalHorasExtras = 0;
                let totalHorasFalta = 0;
                let valorHorasExtras = 0;
                let valorDescontos = 0;
                
                registros.forEach(function(registro) {
                    if (registro.tipo === 'extra') {
                        totalHorasExtras += registro.horas;
                        valorHorasExtras += registro.valor;
                    } else if (registro.tipo === 'falta') {
                        totalHorasFalta += registro.horas;
                        valorDescontos += Math.abs(registro.valor);
                    }
                });
                
                // Cálculo CORRETO do salário final
                const salarioFinal = salarioBase + valorHorasExtras - valorDescontos;
                
                document.getElementById('total-horas-extras').textContent = formatarHoras(totalHorasExtras);
                document.getElementById('total-horas-falta').textContent = formatarHoras(totalHorasFalta);
                document.getElementById('valor-horas-extras').textContent = formatarMoeda(valorHorasExtras);
                document.getElementById('valor-descontos').textContent = formatarMoeda(valorDescontos);
                document.getElementById('salario-final').textContent = formatarMoeda(salarioFinal);
                
                // Aplicar estilo conforme o valor final
                const salarioFinalElement = document.getElementById('salario-final');
                salarioFinalElement.className = salarioFinal >= salarioBase ? 'positivo' : 'negativo';
            }
            
            // Inicializar a interface
            carregarDadosSalvos();
            
            // Salvar automaticamente quando a página for fechada
            window.addEventListener('beforeunload', salvarDados);
        });
    </script>
</body>
</html>